<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <title>Trivia Game</title>
</head>

<body>
    <header class="container">Totally Trivia Game!</header>
    <div class='container'>
        <div>Time Remaining: <span id="time-remaining"></span><span> seconds</span></div>
        <div id='question'></div>
        <form id="form">
            <div id='choices'></div>
            <input id='submit-choice' class="btn btn-primary" type="button" value="Submit">
        </form>
        <div id='result'></div>
    </div>


    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script>

        const timePerQuestion = 5;
        let timer;
        let time = 0;

        const questions = [
            {
                question: 'What is 1 + 1?',
                choices: [1, 2, 3, 4],
                correctIndex: 1,
            },
            {
                question: 'What is 2 + 2?',
                choices: [1, 2, 3, 4],
                correctIndex: 3,
            }
        ];

        const game = {
            currentQuestionId: 0,
            correctAnswers: 0,
            IncorrectAnswers: 0,
            unanswered: 0,

            resetGame() {
                this.correctAnswers = 0;
                this.IncorrectAnswers = 0;
                this.unanswered = 0;
            }
        }

        function secondsToMiliseconds(seconds) {
            return 1000 * seconds
        }



        $(document).ready(function () {

            function startTimer() {
                time = timePerQuestion;
                timer = setInterval(showTime, secondsToMiliseconds(1));
            }

            function stopTimer() {
                clearTimeout(timer);
            }

            function showTime() {
                time--;
                if (time === 0) {
                    stopTimer();
                    showResult()
                }
                $('#time-remaining').text(time);
            }

            function showQuestion() {

                const question = questions[game.currentQuestionId];
                $('#question').html(question.question);

                question.choices.forEach(item => {
                    const choice = $('<div>').addClass('form-check');
                    const input = $('<input>')
                        .addClass('form-check-input')
                        .attr('type', 'radio')
                        .attr('name', 'choice')
                        .attr('value', item)
                        .prop('required', true)
                    const label = $('<label>').addClass('form-check-label').text(item);

                    choice.append(input).append(label)
                    $('#choices').append(choice);
                });
                startTimer();
                $('#submit-choice').show()
            }

            function showResult() {
                $('#question').empty();
                $('#choices').empty();
                $('#submit-choice').hide()
                const message = $('<h2>');
                if (time === 0) {
                    message.text('Out of time!');
                    const correctAnswer = $('<h2>');
                    const question =  questions[game.currentQuestionId];
                    correctAnswer.text('The correct answer is ' + question.choices[question.correctIndex])
                    $('#result').append(message).append(correctAnswer)
                } else {
                    console.log("You chose value " + $("input[name='choice']:checked").val());
                }
            }

            $('#submit-choice').click(function () {
                if (!$("input[name='choice']:checked").val()) {
                    console.log("you must make a selection")
                } else {
                    stopTimer();
                    showResult();

                }

            });

            showQuestion();
        });

    </script>

    <!-- <script src='./assets/javascript/app.js'></script> -->

</body>

</html>